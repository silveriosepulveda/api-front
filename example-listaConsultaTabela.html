<!DOCTYPE html>
<html ng-app="app">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exemplo - Lista Consulta Tabela</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- CSS da diretiva -->
    <link href="css/lista-consulta-tabela.css" rel="stylesheet">
    
    <!-- Angular -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
</head>
<body ng-controller="ExemploCtrl">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <h2>Exemplo - Lista Consulta Tabela</h2>
                <p>Esta é uma demonstração da nova diretiva listaConsultaTabela.</p>
                
                <!-- Controles -->
                <div class="mb-3">
                    <label class="form-label">Tipo de Lista:</label>
                    <select class="form-select" ng-model="tipoLista" ng-change="alterarTipoLista()">
                        <option value="lista">Lista Original</option>
                        <option value="tabela">Tabela Nova</option>
                    </select>
                </div>
                
                <!-- Diretiva -->
                <lista-consulta estrutura="estrutura" lista-consulta="dados"></lista-consulta>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/directives/directivesPadrao.js"></script>
    <script src="js/directives/listaConsulta.js"></script>
    <script src="js/directives/listaConsultaTabela.js"></script>
    <script src="js/directives/sources/montaHtml.js"></script>
    
    <script>
        angular.module('app', [])
        .controller('ExemploCtrl', function($scope) {
            // Dados de exemplo
            $scope.dados = [
                {
                    id: 1,
                    nome: "João Silva",
                    email: "joao@email.com",
                    status: "A",
                    telefone: "(11) 99999-9999",
                    data_cadastro: "2024-01-15"
                },
                {
                    id: 2,
                    nome: "Maria Santos",
                    email: "maria@email.com",
                    status: "A",
                    telefone: "(11) 88888-8888",
                    data_cadastro: "2024-01-16"
                },
                {
                    id: 3,
                    nome: "Pedro Costa",
                    email: "pedro@email.com",
                    status: "I",
                    telefone: "(11) 77777-7777",
                    data_cadastro: "2024-01-17"
                },
                {
                    id: 4,
                    nome: "Ana Oliveira",
                    email: "ana@email.com",
                    status: "A",
                    telefone: "(11) 66666-6666",
                    data_cadastro: "2024-01-18"
                },
                {
                    id: 5,
                    nome: "Carlos Ferreira",
                    email: "carlos@email.com",
                    status: "I",
                    telefone: "(11) 55555-5555",
                    data_cadastro: "2024-01-19"
                }
            ];

            // Estrutura da consulta
            $scope.estrutura = {
                tipoListaConsulta: 'tabela', // Pode ser 'lista' ou 'tabela'
                tabela: 'usuarios',
                campo_chave: 'id',
                nomeUsual: 'Usuário',
                botoesAcoesItensConsultaPosicao: 'esquerda',
                listaConsulta: {
                    id: {
                        texto: "ID",
                        tipo: "texto"
                    },
                    nome: {
                        texto: "Nome",
                        tipo: "texto",
                        habilitarEdicao: true
                    },
                    email: {
                        texto: "E-mail",
                        tipo: "texto"
                    },
                    status: {
                        texto: "Status",
                        tipo: "select",
                        opcoes: [
                            {valor: 'A', texto: 'Ativo'},
                            {valor: 'I', texto: 'Inativo'}
                        ]
                    },
                    telefone: {
                        texto: "Telefone",
                        tipo: "texto"
                    },
                    data_cadastro: {
                        texto: "Data Cadastro",
                        tipo: "texto"
                    }
                },
                funcaoAlterar: "editarUsuario",
                funcaoExcluir: "excluirUsuario",
                funcaoDetalhar: "detalharUsuario"
            };

            // Funções de exemplo
            $scope.editarUsuario = function(item) {
                alert('Editar usuário: ' + item.nome);
            };

            $scope.excluirUsuario = function(item) {
                if (confirm('Deseja excluir o usuário ' + item.nome + '?')) {
                    var index = $scope.dados.indexOf(item);
                    $scope.dados.splice(index, 1);
                }
            };

            $scope.detalharUsuario = function(item) {
                item.exibirDetalhes = !item.exibirDetalhes;
            };

            // Função para alterar tipo de lista
            $scope.alterarTipoLista = function() {
                $scope.estrutura.tipoListaConsulta = $scope.tipoLista;
            };

            // Inicializar
            $scope.tipoLista = 'tabela';
        });
    </script>
</body>
</html>

